<script type="text/javascript">
$(document).ready(function() {
	$("#profile_form").validate({
		rules: {
			fullname: {
				required: true,
				minlength: 3
			},
			nohp: {
				required: true
			}
		},
		messages: {
			fullname: {
				required: "{{ 'Nama Lengkap harus diisi'|lang }}",
				minlength: "{{ 'Nama Lengkap minimal 3 karakter'|lang }}"
			},
			nohp: {
				required: "{{ 'No. Handphone harus diisi'|lang }}"
			}
		},
		errorLabelContainer: '.errorMsg',
		errorElement: 'div',
		submitHandler: function() {
			$.ajax({
				type: 'POST',
				url: $('#profile_form').attr('action'),
				data: $('#profile_form').serialize(),
				dataType:"json",
				success: function (data) {
					if (data.status == 1) {
               			$('#result_profile').html(data.msg).show();
						normalText();
					}
					else if (data.status == 2) {
						$('#result_profile').html(data.msg).show();
					}
				}
			});
			return false;
		}
	});
	
	$("#change-profile").live("click", updateText);
	
	function updateText() {
		sName = $(".change-profile").find(".edit-fullname").text();
		sMobile = $(".change-profile").find(".edit-nohp").text();
		$(".change-profile").find(".edit-fullname").html('<input class="form-control" type="text" name="fullname" id="fullname"  value="' + sName + '" />');
		$(".change-profile").find(".edit-nohp").html('<input class="form-control" type="text" name="nohp" id="nohp"  value="' + sMobile + '" />');
		$(".change-profile").find(".edit-submit").html('<input class="btn btn-primary pull-right" type="submit" name="edit_profile" value="{{ 'Simpan'|lang }}" />');
	}
	
	function normalText() {
		sName = $(".change-profile").find("#fullname").val();
		sMobile = $(".change-profile").find("#nohp").val();
		$(".change-profile").find(".edit-fullname").html(sName);
		$(".change-profile").find(".edit-nohp").html(sMobile);
		$(".change-profile").find(".edit-submit").html('<input id="change-profile" class="btn btn-primary pull-right" type="button" value="{{ 'Ubah data diri'|lang }}" />');
	}
});
</script>

<div class="row">
	<h3>{{ 'Data Diri'|lang }}</h3>


<div id="result_profile"><div class="errorMsg" style="display:none;"></div></div>

<form id="profile_form" class="form-vertical col-md-7" name="profile_form" method="post" action="{{ profile_action_url }}">
<div class="change-profile">
	<!-- email -->
<div class="form-group">
    <label class="col-md-3">{{ 'Email'|lang }}</label>
    <div class="col-md-9">
       {{ email }}
    </div>
</div>

<!-- username -->
<div class="form-group">
    <label class="col-md-3">{{ 'Username'|lang }}</label>
    <div class="col-md-9">
      {{ username }}
    </div>
</div>

<!-- fullname -->
<div class="form-group">
    <label class="col-md-3">{{ 'Nama Lengkap'|lang }} <span>*</span></label>
    <div class="col-md-9 edit-fullname">
     {{ fullname }}
    </div>
</div>

<!-- handphone -->
<div class="form-group">
    <label class="col-md-3">{{ 'No. Handphone'|lang }}  <span>*</span></label>
    <div class="col-md-9 edit-nohp">
     {{ hp }}
    </div>
</div>

<!-- submit -->
<div class="form-group">
    <div class="col-md-9 col-md-offset-3 edit-submit">
       <input id="change-profile" class="btn btn-primary pull-right" type="button" value="{{ 'Ubah data diri'|lang }}" />
    </div>
</div>

</div>

</form>
</div>